#:import utils kivy.utils

TabManager:
    SignUpScreen:
    LoginScreen:
    ForgotScreen:
    HomeScreen:
    Search:
    Note:
    Notify:
    Make_Tracker:
    Goal:
    Chat:
    Info:
    FeedBack:




<Categories>
    id:get_categ

    CheckboxLeftWidget:
        id: check
        active: False
        on_active: root.on_checkbox_Active()


<Content>
    orientation: "vertical"
    size_hint_y: None


#for decorating
<ElementCard@FloatLayout>:

    size_hint: None,None
    padding: 10
    spacing: 10
<SearchElement@GridLayout>
    cols: 2
    size_hint: None,None
    size: 200,50

    spacing: 10
    canvas.before:
        Color:
            rgba: utils.get_color_from_hex("#ffffff")
        RoundedRectangle:
            radius: [40]
            size: self.size
            pos: self.pos

<NotifElement@FloatLayout>

    size_hint: None,None
    size: 300,160
    canvas.before:
        Color:
            rgba: utils.get_color_from_hex("#ffffff")
        RoundedRectangle:
            radius: [40,40,0,0]
            size: self.size
            pos: self.pos


#our main screen
<HomeScreen>:
    name: "Home"
    on_enter: root.customize(root.manager.get_screen("Login").ids.username.text)

    BoxLayout:
        id: box
        orientation: "vertical"
        size: root.width, root.height
        MDToolbar:
            id: toolbar
            title: "Welcome"
            md_bg_color: utils.get_color_from_hex("#86b2d2")
            right_action_items: [["account", lambda x: account_info.set_state("open")]]

        MDBottomNavigation:

            MDBottomNavigationItem:
                name: "Recipe Screen"
                icon: "bowl-mix"

                MDBoxLayout:
                    id: recipie_card
                    size_hint: None,None
                    size: 300,400
                    pos_hint: {"center_x":0.5,"center_y":0.5}
                    canvas.before:
                        Color:
                            rgba: utils.get_color_from_hex("#b8ebda")
                        RoundedRectangle:
                            radius: [15]
                            size: self.size
                            pos: self.pos
                    FloatLayout:
                        ElementCard:
                            pos_hint: {"center_x":0.5,"center_y":0.84}
                            size: 280,110
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#ffd1df")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos

                            SearchElement:
                                pos_hint: {"center_x":0.5,"center_y":0.3}
                                MDIconButton:
                                    pos_hint: {"center_x":0.5,"center_y":0.5}
                                    icon: "magnify"
                                    on_release: app.root.current = "SearchRecipies"
                                MDLabel:
                                    markup: True
                                    text: "[size=10sp][i]Feeling spicy?[/i][/size]\nMake a recipe!"
                                    pos_hint: {"center_x":0.5,"center_y":0.5}
                            Image:
                                source: "Images/recp_1.png"
                                pos_hint:{"center_x":0.5,"center_y":0.78}
                            Image:
                                source: "Images/fork_1.png"
                                pos_hint:{"center_x":0.9,"center_y":0.68}
                            Image:
                                source: "Images/fork_2.png"
                                pos_hint:{"center_x":0.1,"center_y":0.68}
                        ElementCard:
                            id: notifs
                            pos_hint: {"center_x":0.7,"center_y":0.43}
                            size: 150,180
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#e7ee98")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos
                            Image:
                                source: "Images/notif.png"
                                pos_hint: {"center_x":.5,"center_y":0.66}
                            MDRaisedButton:
                                md_bg_color: utils.get_color_from_hex("#3DC3FF")
                                markup: True
                                text: "[b][size=12sp]set reminders\nfor meal time[/size][/b]"
                                halign:"center"
                                pos_hint: {"center_x":.5,"center_y":0.18}
                                on_press: app.root.current = "notify"


                        ElementCard:
                            id: notes
                            pos_hint: {"center_x":0.23,"center_y":0.35}
                            size: 110,250
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#e1c4f5")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos
                            Image:
                                source: "Images/note.png"
                                pos_hint: {"center_x":.5,"center_y":0.8}
                            Image:
                                source: "Images/note_2.jpg"
                                pos_hint: {"center_x":.5,"center_y":0.4}
                            MDRaisedButton:
                                text: "Your Notes"
                                on_release: app.root.current = "Notes"
                                pos_hint: {"center_x":.5,"center_y":0.14}
                                md_bg_color: utils.get_color_from_hex("#d0aed7")
                        Image:
                            pos_hint: {"center_x":0.7,"center_y":0.11}
                            source: "Images/recipe_log.png"

            MDBottomNavigationItem:
                name: "Main Screen"
                icon: "home"

                BoxLayout:
                    id: home
                    size_hint: None,None
                    size: 300,400
                    orientation: "vertical"
                    padding:10
                    spacing: 10
                    pos_hint: {"center_x":0.5,"center_y":0.5}
                    canvas.before:
                        Color:
                            rgba: utils.get_color_from_hex("#d7c6cf")
                        RoundedRectangle:
                            radius: [10]
                            size: self.size
                            pos: self.pos
                    FloatLayout:
                        ElementCard:
                            pos_hint: {"center_x":0.5,"center_y":0.84}
                            size: 280,110
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#ffd1df")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos
                            MDFillRoundFlatButton:
                                text: "Your\nCommunity"
                                halign: "center"
                                text_align:'center'
                                pos_hint: {"center_x":0.24,"center_y":0.5}
                                on_press: app.root.current = "chat"
                                md_bg_color: utils.get_color_from_hex("#bcc8e5")
                            Image:
                                pos_hint: {"center_x":0.7,"center_y":0.5}
                                source: "Images/chat_4.png"

                        ElementCard:
                            pos_hint: {"center_x":0.5,"center_y":0.5}
                            size: 280,110
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#dcedc1")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos
                            MDFillRoundFlatButton:
                                text: "Understanding\nThe Journey"
                                md_bg_color: utils.get_color_from_hex("#c6e299")
                                pos_hint: {"center_x":0.24,"center_y":0.5}
                                on_press: root.info()
                            Image:
                                pos_hint: {"center_x":0.7,"center_y":0.5}
                                source: "Images/book.png"


                        ElementCard:
                            pos_hint: {"center_x":0.5,"center_y":0.17}
                            size: 280,110
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#eec1ad")
                                RoundedRectangle:
                                    radius: [30]
                                    size: self.size
                                    pos: self.pos
                            MDFillRoundFlatButton:
                                text: "Creating Your\nGoals"
                                valign: "center"
                                md_bg_color: utils.get_color_from_hex("#eab198")
                                pos_hint: {"center_x":0.24,"center_y":0.5}
                                on_press: app.root.current = "goals"
                            Image:
                                pos_hint: {"center_x":0.73,"center_y":0.5}
                                source: "Images/goal.png"


            MDBottomNavigationItem:
                name: "Data Screen"
                icon: "chart-bar"
                id: screen

                FloatLayout:
                    BoxLayout:
                        id: create_graph
                        size_hint: None,None
                        size: 300,400
                        orientation: "vertical"
                        padding:10
                        spacing: 3
                        pos_hint: {"center_x":0.5,"center_y":0.5}
                        canvas.before:
                            Color:
                                rgba: utils.get_color_from_hex("#eeeeee")
                            RoundedRectangle:
                                radius: [10]
                                size: self.size
                                pos: self.pos
                    FloatLayout:
                        id: flat
                        pos_hint:{"center_x":.5,"center_y":.5}


    MDNavigationDrawer:
        id: account_info
        BoxLayout:
            orientation:"vertical"
            Image:
                source: "Images/logo.png"
                size: self.texture_size
            ScrollView:
                MDList:
                    OneLineIconListItem:
                        text: "logout"
                        on_release: app.root.current = "Login"
                        IconLeftWidget:
                            icon:"logout"



<FeedBack>
    name: "feedback"
    md_bg_color: utils.get_color_from_hex("#BAE1FF")

    FloatLayout:
        MDFloatLayout:
            pos_hint: {"center_x": 0.4,"center_y": 0.8}
            canvas.before:
                Color:
                    rgba: utils.get_color_from_hex("#BAE1FF")
                Ellipse:
                    size:self.size
                    pos: self.pos
        Image:
            source: "Images/feed_back_logo.png"
            pos_hint: {"center_x": 0.4,"center_y": 0.65}

    BoxLayout:

        orientation: "vertical"
        MDToolbar:
            title: "Help Us Improve"
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#c0c5ce")
        FloatLayout:

            spacing: 10
            padding: 20
            BoxLayout:
                size_hint: None, None
                size: 350,300
                elevation: 30
                pos_hint: {"center_x":0.5,"center_y":0.2}
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex("#c0c5ce")
                    RoundedRectangle:
                        radius: [40]
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: None, None
                size: 320,270
                elevation: 30
                pos_hint: {"center_x":0.5,"center_y":0.2}
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex("#ffffff")
                    RoundedRectangle:
                        radius: [40]
                        pos: self.pos
                        size: self.size
            MDTextField:
                id: feedback
                multiline: True
                mode: "rectangle"
                hint_text: "report any bugs,give feedback"
                line_color_focus: 0, 0, 0, 0.8

                hint_text_color: 0, 0, 0, 0.8
                size_hint_x: None
                width: 260
                pos_hint: {"center_x":0.5,"center_y":0.3}

            MDRaisedButton:
                text: "submit"
                md_bg_color: utils.get_color_from_hex("#a7adba")
                pos_hint: {"center_x":0.5,"center_y":0.1}
                on_press: root.feedback(root.manager.get_screen("Login").ids.username.text)





<Goal>:
    name: "goals"
    on_enter: root.load_goals(root.manager.get_screen("Login").ids.username.text)
    BoxLayout:

        orientation: "vertical"
        MDToolbar:
            title: "Your Goals"
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#efbdaf")
        ScrollView:
            MDList:
                id: list
        BoxLayout:
            id: layout
            orientation: "vertical"
            size_hint: None,None



<Notify>:
    name: "notify"
    BoxLayout:
        orientation: "vertical"
        MDToolbar:
            title: "Set Reminders"
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#E7EE98")

        FloatLayout:

            MDCard:
                size_hint: None,None
                size: 300,400
                orientation: "vertical"
                pos_hint: {"center_x":0.5,"center_y":0.5}
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex("#58BDEB")
                    Rectangle:
                        pos: self.pos
                        size: self.size


                FloatLayout:
                    Image:
                        source: "Images/notif_2.png"
                        pos_hint: {"center_x":.5,"center_y":.7}
                    NotifElement:
                        pos_hint: {"center_x":.5,"center_y":.2}
                    MDTextField:
                        id: time_set
                        mode: "rectangle"
                        width: 100
                        hint_text: "enter hours"
                        max_length: 1
                        pos_hint: {"center_x":0.5,"center_y":0.3}
                        size_hint_x: None

                    MDRaisedButton:
                        text: "set"
                        on_press: root.choose_time()
                        pos_hint: {"center_x":0.5,"center_y":0.15}

<Make_Tracker>
    name: "makeTracker"

    BoxLayout:
        orientation: "vertical"
        padding: 20
        MDLabel:
            markup: True
            text: "Choose your tracking categories [b](please choose 3)[/b]"
            halign: "center"
            pos_hint: {"center_x":.5,"center_y":.5}
        ScrollView:
            MDList:
                id: list
                OneLineIconListItem:
                    id: check_11
                    divider: None
                    text: "was I active today"
                    CheckboxLeftWidget:
                        id: check_1

                OneLineIconListItem:
                    id: check_22
                    divider: None
                    text: "meals eaten"
                    CheckboxLeftWidget:
                        id: check_2

                OneLineIconListItem:
                    id: check_33
                    divider: None
                    text: "water drank (in cups)"
                    CheckboxLeftWidget:
                        id: check_3
                        active:
                OneLineIconListItem:
                    id: check_44
                    divider: None
                    text: "time gone without binging"
                    CheckboxLeftWidget:
                        id: check_4


                OneLineIconListItem:
                    id: check_55
                    divider: None
                    text: "hours slept"
                    CheckboxLeftWidget:
                        id: check_5

        MDRaisedButton:
            pos_hint: {"center_x":.5,"center_y":.5}
            text: "submit"
            on_press: root.user_submit(root.manager.get_screen("Login").ids.username.text)



        MDLabel:
            markup: True
            halign: "center"
            text: "..or make your own!\n[size=12][i]please make these categories trackable\n by numerical values or 'yes'/'no'[/i][/size]"
            pos_hint: {"center_x":.5,"center_y":.5}
        MDTextField:
            id: cust_1
            hint_text: "enter the name of your first category"
            pos_hint: {"center_x":.5,"center_y":.5}

        MDTextField:
            id: cust_2
            hint_text: "enter the name of your second category"
            pos_hint: {"center_x":.5,"center_y":.5}
        MDTextField:
            id: cust_3
            hint_text: "enter the name of your third category"
            pos_hint: {"center_x":.5,"center_y":.5}
        MDRaisedButton:
            text: "submit"
            on_press: root.submit(root.manager.get_screen("Login").ids.username.text)
            pos_hint: {"center_x":.5,"center_y":.5}


#recipe search screen
<Search>:
    name: "SearchRecipies"
    BoxLayout:
        orientation: "vertical"
        MDToolbar:
            elevation: 10
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#F1F5C4")

        BoxLayout:
            orientation: "vertical"
            spacing: 20
            padding: 20
            canvas.before:
                Color:
                    rgba: utils.get_color_from_hex("#F5E1C4")
                Rectangle:
                    pos: self.pos
                    size: self.size
            MDTextField:
                id: search_input
                mode: "rectangle"
                line_color_focus: 0, 0, 0, 0.8
                pos_hint:{"center_x":0.5}
                hint_text: 'search a food'
                hint_text_color: 0, 0, 0, 0.8
                icon_right: 'magnify'
                icon_right_color_normal: 0, 0, 0, 0.8
                size_hint_x: None
                width: 150
                font_size: 16
                multiline: False
                on_text_validate: root.get_search()
            ScrollView:
                id: scrollview
                Recipe:
                    id: recipe_view
                    cols: 1
                    row_default_height: (self.width - self.cols*self.spacing[0]) / self.cols
                    row_force_default: True
                    adaptive_height: True
                    padding: dp(4), dp(4)
                    spacing: dp(20)

<Note>
    name: "Notes"
    on_enter: root.load_notes(root.manager.get_screen("Login").ids.username.text)
    BoxLayout:
        orientation: "vertical"
        MDToolbar:
            right_action_items: [["bookmark-check", lambda x: root.add_notes(root.manager.get_screen("Login").ids.username.text) ]]
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#F1CBFF")

        FloatLayout:
            ScrollView:
                id: scrollview
                TextInput:
                    id: user_text

                    font_size: '25sp'
                    size_hint: 1, None
                    background_color: utils.get_color_from_hex(	"#f8e5ff")
                    height: max( (len(self._lines)+1) * self.line_height, scrollview.height)


<Chat>
    name: "chat"
    on_enter: root.load_text()
    BoxLayout:
        orientation: "vertical"
        MDToolbar:

            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#ffdaea")
        BoxLayout:
            orientation: "vertical"
            padding: 10
            ScrollView:
                id: scroll
                MDLabel:
                    id: chatroom
                    text_size: self.width,None
                    height: self.texture_size[1]
                    size_hint_y:None
                    text: "CHAT REFRESHED"



            MDTextField:
                id: chat_text
                color_mode: "custom"
                mode: "rectangle"

                size_hint_x: None
                width: 350
                line_color_focus: 0, 0, 0, 0.8
                hint_text: "say something.."
                pos_hint: {"center_x":.5,"center_y":.5}
                on_text_validate: root.new_text(root.manager.get_screen("Login").ids.username.text)


#signup screen
<SignUpScreen>:
    name: "SignUp"
    canvas.before:
        Color:
            rgba: utils.get_color_from_hex("#FFFFFF")
        Rectangle:
            pos: self.pos
            size: self.size



    FloatLayout:
        spacing: 10
        padding: 40
        pos_hint: {"center_x": 0.5}
        MDFloatLayout:
            pos_hint: {"center_x": 0.4,"center_y": 0.8}
            canvas.before:
                Color:
                    rgba: utils.get_color_from_hex("#d1e2fa")
                Ellipse:
                    size:self.size
                    pos: self.pos


        Image:
            source: "Images/brand_name.png"
            pos_hint: {"center_x": 0.4,"center_y": 0.8}

        MDLabel:
            markup: True
            font_name: "Dubai-bold"
            text: "[b][size=20]START YOUR JOURNEY[/size][/b]"
            theme_text_color: "Custom"
            text_color: utils.get_color_from_hex("#eeeeee")
            pos_hint: {"center_x": 0.55,"center_y": 0.7}

        MDTextField:
            id: add_email
            hint_text: "email"
            icon_right: "email"
            required: True
            helper_text_mode: "on_error"
            size_hint_x: None

            width: 300
            height: 10
            pos_hint: {"center_x": 0.5,"center_y": 0.5}

        MDTextField:
            id: add_username
            required: True
            helper_text_mode: "on_error"
            max_length: 9
            hint_text: "username"
            icon_right: "account"
            size_hint_x: None
            width: 300
            pos_hint: {"center_x": 0.5,"center_y": 0.4}

        MDTextField:
            id: add_user_password
            required: True
            helper_text_mode: "on_error"
            hint_text: "password"
            icon_right: "eye-off"
            icon_color: 1,1,1,1
            size_hint_x: None
            width: 300
            password: True
            pos_hint: {"center_x": 0.5,"center_y": 0.3}


        MDRaisedButton:
            id: loggedIn
            markup: True
            text: "[b]Sign Up[/b]"
            pos_hint: {"center_x": 0.5,"center_y": 0.2}

            on_press: root.signUp()
            md_bg_color:  utils.get_color_from_hex("#bccbe1")


        MDRaisedButton:
            id: loggedIn
            markup: True
            text: "[b]I have an Account[/b]"
            pos_hint: {"center_x": 0.5,"center_y": 0.1}
            on_press: app.root.current="Login"
            md_bg_color:  utils.get_color_from_hex("#bccbe1")




#loginscreen
<LoginScreen>:
    name: "Login"
    on_enter: self.ids.username.text=""
    FloatLayout:
        MDIconButton:
            icon: "arrow-left"
            pos_hint: {"center_x": 0.06,"center_y": 0.95}
            on_press: app.root.current = "SignUp"

        MDLabel:
            text: "Register"
            pos_hint: {"center_x": 0.6,"center_y": 0.95}
        MDBoxLayout:
            size_hint: None,None
            size: 300,400
            orientation: "vertical"
            spacing: 10
            pos_hint: {"center_x":0.5,"center_y":0.5}
            canvas.before:
                Color:
                    rgba: utils.get_color_from_hex("#d1e2fa")
                RoundedRectangle:
                    radius: [30]
                    size: self.size
                    pos: self.pos
            Image:
                source: "Images/login_logo.png"
                pos_hint: {"center_x":0.47,"center_y":0.5}

            MDTextField:
                id: username
                hint_text: "username"
                icon_right: "account"
                size_hint_x: None
                width: 210
                pos_hint: {"center_x": 0.5}

            MDTextField:
                id: user_password
                hint_text: "password"
                icon_right: "eye-off"
                size_hint_x: None
                width: 210
                password: True
                pos_hint: {"center_x": 0.5}


            MDFillRoundFlatButton:
                id: loggedIn
                markup: True
                text: "[color=#bccbe1][b]login[/b][/color]"
                md_bg_color: utils.get_color_from_hex("#eeeeee")
                pos_hint: {"center_x": 0.5}
                on_press: root.login()


            MDTextButton:
                id: forgot_pass
                markup: True
                text: "[color=#000b80][size=12sp]Forgot password?[/size][/color]"
                pos_hint: {"center_x": 0.5}
                on_press: app.root.current="Forgot"

            Widget:
                size_hint: None,None
                size: 10,20


#forgot password
<ForgotScreen>:
    name: "Forgot"
    FloatLayout:
        MDIconButton:
            icon: "arrow-left"
            pos_hint: {"center_x": 0.06,"center_y": 0.95}
            on_press: app.root.current = "Login"

        MDLabel:
            text: "Login"
            pos_hint: {"center_x": 0.6,"center_y": 0.95}
        MDBoxLayout:
            size_hint: None,None
            size: 300,400
            orientation: "vertical"
            padding:10
            spacing: 10
            pos_hint: {"center_x":0.5,"center_y":0.5}

            canvas.before:
                Color:
                    rgba: utils.get_color_from_hex("#d1e2fa")
                RoundedRectangle:
                    radius: [30]
                    size: self.size
                    pos: self.pos
            Image:
                source: "Images/forgot_logo.png"


            MDTextField:
                id: _username
                hint_text: "username"
                icon_right: "account"
                size_hint_x: None
                width: 210
                pos_hint: {"center_x": 0.5}

            MDTextField:
                id: new_password
                hint_text: "new password"
                icon_right: "eye-off"
                size_hint_x: None
                width: 210
                password: True
                pos_hint: {"center_x": 0.5}

            MDFillRoundFlatButton:
                id: loggedIn
                markup: True
                text: "[color=#bccbe1][b]login[/b][/color]"
                pos_hint: {"center_x": 0.5}
                md_bg_color: utils.get_color_from_hex("#eeeeee")
                on_press: root.forgot_pass()



            Widget:
                size_hint: None,None
                size: 10,40





<Info@Screen>
    name: "info"
    canvas.before:
        Color:
            rgba: utils.get_color_from_hex("#cae4c0")
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:

        orientation: "vertical"
        MDToolbar:
            left_action_items: [["arrow-left", lambda x: app.set_screen('Home') ]]
            md_bg_color: utils.get_color_from_hex("#b0c4a8")
        Carousel:
            direction: "right"
            MDCard:
                size_hint: None,None
                size: 300,400
                pos_hint:{"center_x":0.5,"center_y":0.5}
                size_hint_y: None
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex("#ffffff")
                    Rectangle:
                        pos: self.pos
                        size: self.size
                FloatLayout:
                    Image:
                        source: "Images/trigs.png"
                        pos_hint: {"center_x":.5,"center_y":.5}
                    MDLabel:
                        markup: True
                        text: "[size=13][b]Understand \nyour triggers and \nreverse their effects[/b][/size]"
                        pos_hint: {"center_x":.55,"center_y":.45}
                        halign: "center"
                    MDFloatingActionButton:
                        pos_hint: {"center_x":.25,"center_y":.5}
                        on_press: root.trigs()
                        type: "large"
                        icon: "alert-decagram-outline"
                        md_bg_color: utils.get_color_from_hex("#ffffa1")
                        size_hint: None, None
                        size: 100, 150


